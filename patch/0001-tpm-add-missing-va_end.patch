From 6ff16d90ff1b4307f03b9ef45cfd1a1dc972d1e2 Mon Sep 17 00:00:00 2001
From: Heinrich Schuchardt <xypron.glpk@gmx.de>
Date: Tue, 24 Oct 2017 20:09:48 +0200
Subject: [PATCH 1/1] tpm: add missing va_end

Each va_start must be matched by a va_end.

Signed-off-by: Heinrich Schuchardt <xypron.glpk@gmx.de>
---
 lib/tpm.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/lib/tpm.c b/lib/tpm.c
index d1cf5a8a16..c04bc92295 100644
--- a/lib/tpm.c
+++ b/lib/tpm.c
@@ -170,8 +170,10 @@ int unpack_byte_string(const uint8_t *str, size_t size, const char *format, ...)
 			return -1;
 		}
 
-		if (offset + length > size)
+		if (offset + length > size) {
+			va_end(args);
 			return -1;
+		}
 
 		switch (*format) {
 		case 'b':
-- 
2.11.0

