From d604a4b10fb51c0e7fdaaf92c9abac3ddf0684e4 Mon Sep 17 00:00:00 2001
From: Heinrich Schuchardt <xypron.glpk@gmx.de>
Date: Tue, 12 Dec 2017 21:10:44 +0100
Subject: [PATCH 1/1] efi_loader: debug output installed device path

When a device path protocol is installed write the device
path to the console in debug mode.

Signed-off-by: Heinrich Schuchardt <xypron.glpk@gmx.de>
---
 lib/efi_loader/efi_boottime.c | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/lib/efi_loader/efi_boottime.c b/lib/efi_loader/efi_boottime.c
index 8f9e783625..efcab6c84a 100644
--- a/lib/efi_loader/efi_boottime.c
+++ b/lib/efi_loader/efi_boottime.c
@@ -893,6 +893,13 @@ efi_status_t efi_add_protocol(const void *handle, const efi_guid_t *protocol,
 	handler->protocol_interface = protocol_interface;
 	INIT_LIST_HEAD(&handler->open_infos);
 	list_add_tail(&handler->link, &efiobj->protocols);
+#if _DEBUG == 1
+	if (!guidcmp(&efi_guid_device_path, protocol)) {
+		debug("%sEFI installed device path: %ls\n", __efi_nesting(),
+		      efi_dp_str((struct efi_device_path *)
+				 protocol_interface));
+	}
+#endif
 	return EFI_SUCCESS;
 }
 
-- 
2.14.2

