From 104df037587fcdcfc679f8f76fe52ebe5a03daff Mon Sep 17 00:00:00 2001
From: Heinrich Schuchardt <xypron.glpk@gmx.de>
Date: Sat, 21 Oct 2017 10:51:05 +0200
Subject: [PATCH 1/1] DO NOT MERGE: let uninstall protocol always succeed

Signed-off-by: Heinrich Schuchardt <xypron.glpk@gmx.de>
---
 lib/efi_loader/efi_boottime.c | 14 +++++---------
 1 file changed, 5 insertions(+), 9 deletions(-)

diff --git a/lib/efi_loader/efi_boottime.c b/lib/efi_loader/efi_boottime.c
index 5619412776..6cfaa40b99 100644
--- a/lib/efi_loader/efi_boottime.c
+++ b/lib/efi_loader/efi_boottime.c
@@ -6,6 +6,8 @@
  *  SPDX-License-Identifier:     GPL-2.0+
  */
 
+#define DEBUG 1
+
 #include <common.h>
 #include <div64.h>
 #include <efi_loader.h>
@@ -854,15 +856,9 @@ static efi_status_t EFIAPI efi_uninstall_protocol_interface(void *handle,
 
 			if (!hprotocol)
 				continue;
-			if (!guidcmp(hprotocol, protocol)) {
-				if (handler->protocol_interface) {
-					r = EFI_ACCESS_DENIED;
-				} else {
-					handler->guid = 0;
-					r = EFI_SUCCESS;
-				}
-				goto out;
-			}
+			handler->guid = 0;
+			r = EFI_SUCCESS;
+			goto out;
 		}
 	}
 
-- 
2.14.2

